(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{37:function(e,n,t){e.exports=t(51)},42:function(e,n,t){},43:function(e,n,t){},49:function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=49},51:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(18),o=t.n(c),i=t(33),u=t(15),l=(t(42),t(43),t(6)),s=t(14),d=t(29),p=t(1),f=function(e){return Object(p.a)({},e,{isAllyReady:!0})},h=function(e){return Object(p.a)({},e,{isAllyWantRepeat:!0})},y=function(e){return Object(p.a)({},e,{move:!e.move})},m=function(e,n){return Object(p.a)({},e,{status:n.payload?"connect":"place",type:n.payload?"pvp":"comp",move:!n.payload||e.move})},b=function(e,n){return Object(p.a)({},e,{status:n.payload})},v=function(e){return Object(p.a)({},e,{isEnemyReady:!0})},g=function(e){return Object(p.a)({},e,{isEnemyWantRepeat:!0})},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"choose",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:null,isAllyReady:!1,isEnemyReady:!1,isAllyWantRepeat:!1,isEnemyWantRepeat:!1,status:e,move:n}},k=function(e){return e.match(/\d+-/g).map((function(e){return parseInt(e)}))},O=function(e,n){var t="fire"===n.payload.type?{type:"fire",data:k(n.payload.data)}:Object(p.a)({},n.payload);return console.log("sent:     ",JSON.parse(JSON.stringify(t))),Object(p.a)({},e,{message:t,waitingForFeedback:"fire"===n.payload.type,lastSent:"fire"===n.payload.type?n.payload.data:e.lastSent})},x=function(e,n){return console.log("received: ",JSON.parse(JSON.stringify(n.payload))),Object(p.a)({},e,{waitingForFeedback:!1,lastReceived:"fire"===n.payload.type?"cell-".concat(n.payload.data[0],"-").concat(n.payload.data[1],"-ally"):e.lastReceived})},j=function(e,n){return Object(p.a)({},e,{id:n.payload})},S=function(e){return Object(p.a)({},e,{isClient:!0})},w=function(e,n){return Object(p.a)({},e,{interface:n.payload})},T=function(e){return Object(p.a)({},e,{message:null})},I=function(e){return Object(p.a)({},e,{isConnected:!0})},R=function(e){return Object(p.a)({},e,{isInitialised:!0})},C=t(4),_=function(e){var n=Object(C.a)(Array(10).keys());return n.map((function(t){return n.map((function(n){return{id:"cell-".concat(n,"-").concat(t,"-").concat(e),hit:!1,miss:!1,ship:!1,sank:!1}}))}))},A=t(7),D=function(e){return e.split("-").map((function(e){return parseInt(e)}))},N=function(e){var n=e.squadron.reduce((function(e,n){return e+function(e){return e.map((function(e){return null===e[0]?1:1===e.length?0:e.reduce((function(e,n){return 1===e?1:null===n?1:0}))})).reduce((function(e,n){return e+n}))}(n)}),0),t=Object(p.a)({},e.deckToPlace);e:for(var a=0;a<e.squadron.length;a++)for(var r=0;r<e.squadron[a].length;r++)for(var c=0;c<e.squadron[a][r].length;c++)if(null===e.squadron[a][r][c]){t={type:a,ship:r,deck:c};break e}return Object(p.a)({},e,{shipsToPlace:n,deckToPlace:t})},q=function(e,n,t,a,r,c){var o=Object(p.a)({},r);return c?(o.squadron[e][n].pop(),o.squadron[e][n].unshift(a)):o.squadron[e][n][t]=a,o.squadron[e][n].forEach((function(t,a){t&&(o.ally[t[1]][t[0]].ship="".concat(e,"-").concat(n,"-").concat(a))})),N(o)},L=function(e,n){return e[n[1]][n[0]].ship},P=function(e,n){var t=Object(p.a)({},e),a=k(n.payload),r=L(t.ally,a);if(r){var c=D(r),o=Object(A.a)(c,3),i=o[0],u=o[1],l=o[2];return 0!==l&&t.squadron[i][u][l+1]?t:function(e,n,t,a,r){var c=Object(p.a)({},r);return c.squadron[e][n].splice(t,1),c.squadron[e][n].push(null),c.ally[a[1]][a[0]].ship=!1,c.squadron[e][n].forEach((function(t,a){t&&(c.ally[t[1]][t[0]].ship="".concat(e,"-").concat(n,"-").concat(a))})),N(c)}(i,u,l,a,t)}if(function(e,n){return e[n[1]-1]&&(e[n[1]-1][n[0]-1]&&e[n[1]-1][n[0]-1].ship||e[n[1]-1][n[0]+1]&&e[n[1]-1][n[0]+1].ship)||e[n[1]+1]&&(e[n[1]+1][n[0]-1]&&e[n[1]+1][n[0]-1].ship||e[n[1]+1][n[0]+1]&&e[n[1]+1][n[0]+1].ship)}(t.ally,a))return t;var s=function(e,n){return[e[n[1]-1]&&e[n[1]-1][n[0]]&&e[n[1]-1][n[0]].ship,e[n[1]+1]&&e[n[1]+1][n[0]]&&e[n[1]+1][n[0]].ship,e[n[1]][n[0]-1]&&e[n[1]][n[0]-1].ship,e[n[1]][n[0]+1]&&e[n[1]][n[0]+1].ship].filter((function(e){return e}))}(t.ally,a);if(1===s.length){for(var d=s[0].split("-").map((function(e){return parseInt(e)})),f=Object(A.a)(d,2),h=f[0],y=f[1],m=1;m<t.squadron[h][y].length;m++)if(null===t.squadron[h][y][m]){var b=a[0]<t.squadron[h][y][0][0]||a[1]<t.squadron[h][y][0][1];return q(h,y,m,a,t,b)}return t}for(var v=0;v<t.squadron[t.deckToPlace.type].length;v++){var g=t.squadron[t.deckToPlace.type][v];if(!(g.filter((function(e){return e})).length===g.length))return null===g[0]?q(t.deckToPlace.type,v,0,a,t,!1):t}return t},M=function(e,n){var t=Object(C.a)(e),a=Object(C.a)(n),r=1===a.length?[3,3]:a[1][1]-a[0][1]===0?[a.length+2,3]:[3,a.length+2],c=Object(A.a)(r,2),o=c[0],i=c[1];return Object(C.a)(Array(i).keys()).forEach((function(e){Object(C.a)(Array(o).keys()).forEach((function(n){(function(e,n){return 1===a.length?!(1===e&&1===n):a[1][1]-a[0][1]===0?!(e>0&&e<a.length+1&&1===n):!(n>0&&n<a.length+1&&1===e)})(n,e)&&function(e,n){var r=a[0];t[n-1+r[1]]&&t[n-1+r[1]][e-1+r[0]]&&(t[n-1+r[1]][e-1+r[0]].miss=!0)}(n,e)}))})),t},F=function(e,n){var t,a=[],r=Object(p.a)({},e),c=Object(C.a)(n.payload.data),o=L(r.ally,c);if(o){r.ally[c[1]][c[0]].hit=!0;var i=D(o),u=Object(A.a)(i,2),l=u[0],s=u[1];if(function(e,n,t){return t.squadron[e][n].reduce((function(e,n){return t.ally[n[1]][n[0]].hit&&e}),!0)}(l,s,r)){if(r.allyShipsLeft-=1,0===r.allyShipsLeft)return r.feedback={type:"defeat"},r;r.squadron[l][s].forEach((function(e){r.ally[e[1]][e[0]].sank=!0,a.push(e)})),r.ally=M(r.ally,a),t="sank"}else t="hit"}else t="miss",r.ally[c[1]][c[0]].miss=!0;return 0===a.length&&a.push(c),r.feedback={type:"feedback",data:a,feedback:t},r},z=function(e){return Object(p.a)({},e,{feedback:{type:"victory",data:Object(C.a)(e.ally.map((function(e){return e.map((function(e){return e.miss?1:e.sank?2:e.hit?3:e.ship?4:0}))})))}})},W=function(){return Object(C.a)(Array(4).keys()).map((function(e){return Object(C.a)(Array(e+1)).map((function(n){return Object(C.a)(Array(4-e)).map((function(e){return null}))}))}))},U=function(e){return Object(p.a)({},e,{feedback:null})},V=[[[-3,0],[0,-3]],[[-2,0],[0,-2]],[[-1,0],[0,-1]],[[0,0],[0,0]]],H=function(e){var n=Object(p.a)({},e);try{n.squadron.forEach((function(e,t){n.squadron[t].forEach((function(e,a){var r=function e(n,t){var a=Object(p.a)({},n),r=Math.floor(Math.random()+.5),c=[Math.floor(Math.random()*(10+V[t][r][0])),Math.floor(Math.random()*(10+V[t][r][1]))];try{for(var o=-1;o<=a.squadron[t][0].length+1;o++)if(1===r&&a.ally[c[1]+o]&&(a.ally[c[1]+o][c[0]-1]&&a.ally[c[1]+o][c[0]-1].ship||a.ally[c[1]+o][c[0]]&&a.ally[c[1]+o][c[0]].ship||a.ally[c[1]+o][c[0]+1]&&a.ally[c[1]+o][c[0]+1].ship)||0===r&&(a.ally[c[1]-1]&&a.ally[c[1]-1][c[0]+o]&&a.ally[c[1]-1][c[0]+o].ship||a.ally[c[1]][c[0]+o]&&a.ally[c[1]][c[0]+o].ship||a.ally[c[1]+1]&&a.ally[c[1]+1][c[0]+o]&&a.ally[c[1]+1][c[0]+o].ship))return e(a,t)}catch(u){var i=u.message;return console.error(i),{}}return{coordinates:c,direction:r}}(n,t),c=r.coordinates,o=r.direction;if(!c)throw new Error("Browser too weak for such recursion \ud83d\ude14");n.squadron[t][a]=n.squadron[t][a].map((function(e,n){return 0===o?[c[0]+n,c[1]]:[c[0],c[1]+n]})),n.squadron[t][a].forEach((function(e,r){n.ally[e[1]][e[0]].ship="".concat(t,"-").concat(a,"-").concat(r)}))}))}))}catch(a){var t=a.message;console.error(t)}return N(n)},Y=function(e,n){return Object(p.a)({},e,{enemy:Object(C.a)(n.payload.data.map((function(e,n){return e.map((function(e,t){return{id:"cell-".concat(t,"-").concat(n,"-enemy"),miss:1===e,sank:2===e,hit:3===e||2===e,ship:4===e||3===e||2===e}}))})))})},J=function(e,n){var t=Object(p.a)({},e),a=Object(C.a)(n.payload.data);switch(n.payload.feedback){case"miss":t.enemy[a[0][1]][a[0][0]].miss=!0;break;case"hit":t.enemy[a[0][1]][a[0][0]].ship=!0,t.enemy[a[0][1]][a[0][0]].hit=!0;break;case"sank":if(a.forEach((function(e){t.enemy[e[1]][e[0]].hit=!0,t.enemy[e[1]][e[0]].ship=!0,t.enemy[e[1]][e[0]].sank=!0})),t.enemy=M(t.enemy,a),t.enemyShipsLeft-=1,0===t.enemyShipsLeft)return t.feedback={type:"victory",data:Object(C.a)(t.ally)},t}return t},X=function(){return{ally:_("ally"),enemy:_("enemy"),squadron:W(),shipsToPlace:10,deckToPlace:{type:0,ship:0,deck:0},allyShipsLeft:10,enemyShipsLeft:10,feedback:null}},G=Object(s.c)({game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E(),n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SELECT_TYPE":return m(e,n);case"CHANGE_STATUS":return b(e,n);case"READY":return f(e);case"REPEAT":return h(e);case"SEND":switch(n.payload.type){case"feedback":return"miss"===n.payload.feedback?y(e):e;case"victory":return b(e,{payload:"victory"});default:return e}case"RECEIVE":switch(n.payload.type){case"ready":return v(e);case"repeat":return g(e);case"feedback":return"miss"===n.payload.feedback?y(e):e;case"victory":return b(e,{payload:"defeat"});default:return e}case"SET_MOVE":return n.payload?y(e):e;case"RESET":return E();case"NEW_ROUND":return E("place","pvp"!==e.type||!e.move);default:return e}},peer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",message:null,interface:null,isClient:!1,isConnected:!1,isInitialised:!1,waitingForFeedback:!1,lastSent:null,lastReceived:null},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_INTERFACE":return w(e,n);case"SEND":return O(e,n);case"CLEAR_MESSAGE":return T(e);case"READY":return O(e,{payload:{type:"ready"}});case"REPEAT":return O(e,{payload:{type:"repeat"}});case"RECEIVE":return x(e,n);case"SET_ID":return j(e,n);case"SET_IS_CLIENT":return S(e);case"SET_IS_CONNECTED":return I(e);case"SET_IS_INITIALISED":return R(e);case"RESET":return{id:"",message:null,interface:null,isClient:!1,isConnected:!1,isInitialised:!1,waitingForFeedback:!1,lastSent:null,lastReceived:null};default:return e}},sea:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X(),n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SEND":return"feedback"===n.payload.type||"defeat"===n.payload.type||"victory"===n.payload.type?U(e):e;case"PLACE_SHIP":return P(e,n);case"RANDOM":return H(Object(p.a)({},e,{ally:_("ally"),squadron:W()}));case"RECEIVE":switch(n.payload.type){case"fire":return F(e,n);case"feedback":return J(e,n);case"victory":return Y(e,n);case"defeat":return z(e);default:return e}case"RESET":case"NEW_ROUND":return X();default:return e}}}),B=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,K=Object(s.e)(G,B(Object(s.a)(d.a))),Q=t(19),Z=function e(n){var t=this;Object(Q.a)(this,e),this.init=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.state=0,t.shootLog=[],t.lastShoot=null,t.directions=["up","down","left","right"],t.directionsStack=null,t.sea=H(X()),t.fireDelay=250,e&&t.connect()},this.changeState=function(e){switch(t.state){case 0:"hit"===e&&(t.state=1);break;case 1:t.state="hit"===e?2:"sank"===e?0:1;break;case 2:t.state="hit"===e?2:"sank"===e?0:3;break;case 3:t.state="hit"===e?2:0}},this.findLogIndex=function(e){return t.shootLog.findIndex((function(n){return n.cell.toString()===e.toString()}))},this.anotherDirection=function(e){for(var n=Math.floor(4*Math.random());-1!==e.indexOf(n);)n=Math.floor(4*Math.random());return[].concat(Object(C.a)(e),[n])},this.randomDirectionsStack=function(){return Object(C.a)(Array(4)).reduce(t.anotherDirection,[]).map((function(e){return t.directions[e]}))},this.reverseDirection=function(){return(t.directions.indexOf(t.directionsStack[0])+1)%2===0?t.directions[t.directions.indexOf(t.directionsStack[0])-1]:t.directions[t.directions.indexOf(t.directionsStack[0])+1]},this.findHitIndex=function(){return t.shootLog.reduceRight((function(e,n,t){return"hit"===n.feedback&&(-1===e||e-t===1)?t:e}),-1)},this.cannotShoot=function(e){return!t.sea.enemy[e[1]]||!t.sea.enemy[e[1]][e[0]]||t.sea.enemy[e[1]][e[0]].ship||t.sea.enemy[e[1]][e[0]].miss},this.addShift=function(e,n,t){var a=Object(A.a)(e,2),r=a[0],c=a[1];switch(n){case"up":return[r,c-t];case"down":return[r,c+t];case"left":return[r-t,c];case"right":return[r+t,c];default:return}},this.getRandomCoordinates=function(){for(var e=[],n=function(e,n){return e.findIndex((function(e){return e.toString()===n.toString()}))>=0};;){var a=[Math.floor(10*Math.random()),Math.floor(10*Math.random())];if(!n(e,a)){if(!t.cannotShoot(a))return a;e.push(a)}}},this.shoot=function(){switch(t.state){case 0:t.lastShoot=t.getRandomCoordinates();break;case 1:var e=t.findHitIndex();if(null===t.directionsStack?t.directionsStack=t.randomDirectionsStack():t.directionsStack.unshift(),0===t.directionsStack.length)return t.directionsStack=null,t.changeState("sank"),t.shoot();var n=t.directionsStack[0],a=t.addShift(t.shootLog[e].cell,n,1);if(t.cannotShoot(a)||a[0]<0||a[0]>9||a[1]<0||a[1]>9)return t.directionsStack.shift(),t.shoot();t.lastShoot=a;break;case 2:var r=t.directionsStack[0],c=t.addShift(t.lastShoot,r,1);if(t.cannotShoot(c)||c[0]<0||c[0]>9||c[1]<0||c[1]>9)return t.changeState("miss"),t.shoot();t.lastShoot=c;break;case 3:for(var o=t.reverseDirection(),i=t.findHitIndex(),u=t.addShift(t.shootLog[i].cell,o,1);t.cannotShoot(u);)u=t.addShift(u,o,1);t.lastShoot=u,t.directionsStack=[o];break;default:return}t.shootLog.push({cell:t.lastShoot}),setTimeout((function(){t.post({type:"fire",data:t.lastShoot})}),t.fireDelay)},this.send=function(e){switch(e.type){case"fire":t.sea=F(t.sea,{payload:e}),t.post(t.sea.feedback),"miss"===t.sea.feedback.feedback&&t.shoot(),t.sea.feedback=null;break;case"feedback":t.sea=J(t.sea,{payload:e});var n=t.findLogIndex(t.lastShoot);t.shootLog[n].feedback=e.feedback,t.changeState(e.feedback),"sank"===e.feedback&&(t.directionsStack=null),"miss"!==e.feedback&&t.shoot();break;case"defeat":t.sea=z(t.sea),t.post(t.sea.feedback),t.post({type:"repeat"}),t.init(!1);break;case"ready":t.post({type:"ready"});break;case"victory":t.post({type:"repeat"}),t.init(!1)}},this.connect=n.connect,this.post=n.post,this.init()},$=t(2),ee=t(3);function ne(){var e=Object($.a)(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: grid;\n  grid-gap: 1px;\n  grid-template: repeat(10, 1fr) / repeat(10, 1fr);\n"]);return ne=function(){return e},e}function te(){var e=Object($.a)(["var(--gray)"]);return te=function(){return e},e}function ae(){var e=Object($.a)(["var(--silver)"]);return ae=function(){return e},e}function re(){var e=Object($.a)(["var(--olive)"]);return re=function(){return e},e}function ce(){var e=Object($.a)(["var(--yellow)"]);return ce=function(){return e},e}function oe(){var e=Object($.a)(["\n  margin: 8px;\n  width: calc(50vmin - 20px);\n  height: calc(50vmin - 20px);\n  min-width: 292px;\n  min-height: 292px;\n  box-sizing: border-box;\n  border: 2px solid ",";\n  background-color: ",";\n  overflow: hidden;\n"]);return oe=function(){return e},e}var ie=ee.b.div(oe(),(function(e){return e.move?Object(ee.a)(ce()):Object(ee.a)(re())}),(function(e){return e.move?Object(ee.a)(ae()):Object(ee.a)(te())})),ue=ee.b.div(ne()),le=function(e){var n=e.move,t=e.children;return r.a.createElement(ie,{move:n},r.a.createElement(ue,{move:n,children:t}))};function se(){var e=Object($.a)(["var(--white)"]);return se=function(){return e},e}function de(){var e=Object($.a)(["var(--silver)"]);return de=function(){return e},e}function pe(){var e=Object($.a)(["var(--gray)"]);return pe=function(){return e},e}function fe(){var e=Object($.a)(["var(--aqua)"]);return fe=function(){return e},e}function he(){var e=Object($.a)(["\n      :after {\n        content: '';\n        width: 60%;\n        height: 50%;\n        background-color: ",";\n      }\n    "]);return he=function(){return e},e}function ye(){var e=Object($.a)(["var(--gray)"]);return ye=function(){return e},e}function me(){var e=Object($.a)(["var(--aqua)"]);return me=function(){return e},e}function be(){var e=Object($.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n  background-color: var(--blue);\n  color: ",";\n\n  ","\n"]);return be=function(){return e},e}var ve=ee.b.div(be(),(function(e){return e.last?Object(ee.a)(me()):Object(ee.a)(ye())}),(function(e){return e.ship&&Object(ee.a)(he(),e.last?Object(ee.a)(fe()):e.sank?Object(ee.a)(pe()):!e.isCompleted||e.hit?Object(ee.a)(de()):Object(ee.a)(se()))})),ge=function(e){return r.a.createElement(ve,e,e.miss&&"*")},Ee=function(e){var n=e.cell,t=e.squadron;if(!n)return!1;var a=D(n),r=Object(A.a)(a,2),c=r[0],o=r[1];return t[c][o].reduce((function(e,n){return!!e&&null!==n}),!0)},ke=Object(l.b)((function(e){return{game:e.game,peer:e.peer,sea:e.sea}}),(function(e){return{place:function(n){return e({type:"PLACE_SHIP",payload:n})}}}))((function(e){return r.a.createElement(le,{move:"place"===e.game.status||"confirm"===e.game.status||!e.game.move},e.sea.ally.map((function(n){return n.map((function(n){var t=n.id,a=n.ship,c=n.hit,o=n.miss,i=n.sank;return r.a.createElement(ge,{key:t,id:t,last:t===e.peer.lastReceived,ship:a,hit:c,miss:o,sank:i,isCompleted:Ee({cell:a,squadron:e.sea.squadron}),onClick:function(){("place"===e.game.status||"confirm"===e.game.status)&&(e.sea.shipsToPlace>0||a)&&e.place(t)}})}))})))})),Oe=Object(l.b)((function(e){return{game:e.game,peer:e.peer,sea:e.sea}}),(function(e){return{fire:function(n){return e({type:"SEND",payload:{type:"fire",data:n}})}}}))((function(e){return r.a.createElement(le,{move:e.game.move},e.sea.enemy.map((function(n){return n.map((function(n){var t=n.id,a=n.ship,c=n.hit,o=n.miss,i=n.sank;return r.a.createElement(ge,{key:t,id:t,last:t===e.peer.lastSent,ship:a,hit:c,miss:o,sank:i,onClick:function(){"play"===e.game.status&&e.game.move&&!e.peer.waitingForFeedback&&!c&&!o&&e.fire(t)},enemy:!0})}))})))}));function xe(){var e=Object($.a)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-flow: row wrap;\n  align-items: center;\n  justify-content: center;\n"]);return xe=function(){return e},e}var je=ee.b.div(xe()),Se=t(32),we=t.n(Se),Te=function e(n){var t=this;Object(Q.a)(this,e),this.close=function(){t.connection=null,t.disconnect()},this.init=function(){t.peer=new we.a,t.connection=null,t.lastPeerID=null,t.initialised(),t.peer.on("open",(function(){null===t.peer.id?t.peer.id=t.lastPeerID:t.lastPeerID=t.peer.id,t.setId(t.peer.id)})),t.peer.on("connection",(function(e){t.connection?e.on("open",e.close):(t.connection=e,t.ready())})),t.peer.on("disconnected",(function(){t.peer.id=t.lastPeerID,t.peer._lastServerID=t.lastPeerID,t.peer.reconnect()})),t.peer.on("close",t.close),t.peer.on("error",t.close)},this.join=function(e){t.connection=t.peer.connect(e,t.options),t.client(),t.ready()},this.ready=function(){t.connection.on("open",t.open),t.connection.on("data",t.data),t.connection.on("close",t.close)},this.send=function(e){t.connection&&t.connection.open&&t.connection.send(e)},this.disconnect=n.disconnect,this.initialised=n.initialised,this.client=n.client,this.setId=n.setId,this.open=n.open,this.data=n.data,this.options={reliable:!0,serialization:"json"},this.init()};function Ie(){var e=Object($.a)(["\n  margin: 16px auto;\n  display: flex;\n  flex-flow: row;\n  justify-content: center;\n"]);return Ie=function(){return e},e}function Re(){var e=Object($.a)(["\n  position: relative;\n  background-color: var(--black);\n  color: var(--white);\n  overflow: hidden;\n\n  ",":not(:focus) + "," {\n    display: none;\n  }\n"]);return Re=function(){return e},e}function Ce(){var e=Object($.a)(["\n  position: absolute;\n  top: 0;\n  right: 3px;\n  z-index: 1;\n"]);return Ce=function(){return e},e}function _e(){var e=Object($.a)(["\n  position: absolute;\n  top: 0;\n  right: ","px;\n  animation: "," 1s linear infinite;\n"]);return _e=function(){return e},e}function Ae(){var e=Object($.a)(["\n  margin: 0;\n  padding: 0 0 0 4px;\n  height: 16px;\n  min-width: 0;\n  position: relative;\n  z-index: 1;\n  background: none;\n  caret-color: transparent;\n"]);return Ae=function(){return e},e}function De(){var e=Object($.a)(["\n  0% { opacity: 1 }\n  50% { opacity: 1 }\n  51% { opacity: 0 }\n  to { opacity: 0 }\n"]);return De=function(){return e},e}var Ne=Object(ee.c)(De()),qe=ee.b.input.attrs({type:"text",size:17,maxLength:16})(Ae()),Le=ee.b.div(_e(),(function(e){return 147-9*e.caret}),Ne),Pe=ee.b.div(Ce()),Me=ee.b.div(Re(),qe,Le),Fe=ee.b.div(Ie()),ze=function(e){var n=e.onInput,t=e.readonly,c=void 0!==t&&t,o=e.submit,i=e.symbols,u=e.value,l=void 0===u?"":u,s=Object(a.useRef)(null),d=Object(a.useState)(i),p=Object(A.a)(d,2),f=p[0],h=p[1],y=function(e){"keydown"===e.type&&"Enter"===e.key?o():h(e.target.selectionEnd)};!c&&Object(a.useEffect)((function(){s.current.focus()}),[]);var m=c?{onChange:function(e){return e.preventDefault()},value:l}:{onClick:y,onKeyUp:y,onPaste:y,onChange:y,onKeyDown:y,onInput:n};return r.a.createElement(Fe,null,"[",r.a.createElement(Me,null,r.a.createElement(Pe,null,"\xb7".repeat(17-i)),r.a.createElement(qe,Object.assign({ref:s},m)),!c&&r.a.createElement(Le,{caret:f},"_")),"]")};function We(){var e=Object($.a)(["\n  padding: 0 16px;\n  height: 16px;\n  min-width: 60px;\n  background-color: var(--white);\n  box-shadow: 8px 8px 0 var(--black);\n  color: var(--gray);\n\n  & + & {\n    margin-left: 24px;\n  }\n\n  :focus {\n    background-color: var(--yellow);\n    color: var(--maroon);\n  }\n\n  span {\n    color: var(--black);\n  }\n"]);return We=function(){return e},e}var Ue=ee.b.button(We()),Ve=function(e){var n=e.autoFocus,t=e.className,a=e.onClick,c=e.text,o=void 0===c?"":c,i=e.index;return r.a.createElement(Ue,{autoFocus:n,className:t,onClick:"function"===typeof a?a:void 0},void 0===i?o:[o.substring(0,i),r.a.createElement("span",{key:o},o[i]),o.substring(i+1)])};function He(){var e=Object($.a)(["\n  margin-top: 32px;\n"]);return He=function(){return e},e}function Ye(){var e=Object($.a)(["\n  padding: 32px 0;\n  height: 100%;\n  box-sizing: border-box;\n  min-height: 294px;\n  display: flex;\n  flex-flow: column;\n  align-items: center;\n  justify-content: center;\n  border: 3px double var(--black);\n"]);return Ye=function(){return e},e}function Je(){var e=Object($.a)(["\n  margin: 16px 0;\n  padding: 8px 4px;\n  width: 320px;\n  max-width: 80%;\n  position: relative;\n  background-color: var(--teal);\n  box-shadow: 16px 16px 0 var(--black);\n  color: var(--black);\n\n  :before {\n    content: '","';\n    padding: 0 8px;\n    position: absolute;\n    top: 2px;\n    left: 50%;\n    width: max-content;\n    height: 16px;\n    background-color: inherit;\n    color: inherit;\n    transform: translateX(-50%);\n    z-index: 1;\n  }\n"]);return Je=function(){return e},e}var Xe=ee.b.div(Je(),(function(e){return e.title_})),Ge=ee.b.div(Ye()),Be=ee.b.div(He()),Ke=Object(l.b)((function(e){return{game:e.game,peer:e.peer}}),(function(e){return{disconnect:function(){return e({type:"RESET"})},client:function(){return e({type:"SET_IS_CLIENT"})},setId:function(n){return e({type:"SET_ID",payload:n})},data:function(n){return e({type:"RECEIVE",payload:n})},open:function(){return e({type:"SET_IS_CONNECTED"})},initialised:function(){return e({type:"SET_IS_INITIALISED"})},setInterface:function(n){return e({type:"SET_INTERFACE",payload:n})},selectType:function(n){return e({type:"SELECT_TYPE",payload:n})}}}))((function(e){var n=Object(a.useState)(""),t=Object(A.a)(n,2),c=t[0],o=t[1],i=function(){c&&""!==c&&c!==e.peer.id&&e.peer.interface.join(c)};switch(Object(a.useEffect)((function(){"connect"===e.game.status&&null===e.peer.interface&&e.setInterface(new Te({disconnect:e.disconnect,initialised:e.initialised,client:e.client,setId:e.setId,open:e.open,data:e.data}))}),[e]),e.game.status){case"choose":return r.a.createElement(Xe,{title_:"select game type"},r.a.createElement(Ge,null,r.a.createElement("p",null,"you want to play with"),r.a.createElement(Be,null,r.a.createElement(Ve,{autoFocus:!0,onClick:function(){e.selectType(!0)},text:"person",index:0}),r.a.createElement(Ve,{onClick:function(){e.selectType(!1)},text:"computer",index:0}))));case"connect":return""===e.peer.id?r.a.createElement(Xe,{title_:"connect to remote player"},r.a.createElement(Ge,null,"please wait")):r.a.createElement(Xe,{title_:"connect to remote player"},r.a.createElement(Ge,null,r.a.createElement("label",null,"share this code",r.a.createElement("br",null),"with someone",r.a.createElement("br",null),"you want to play:"),r.a.createElement(ze,{symbols:e.peer.id.length,value:e.peer.id,readonly:!0}),r.a.createElement("label",null,"or paste code that",r.a.createElement("br",null),"was shared to you:"),r.a.createElement(ze,{onInput:function(e){var n=e.target.value;o(n)},submit:i,symbols:c.length}),r.a.createElement(Be,null,r.a.createElement(Ve,{onClick:i,text:"connect"}),r.a.createElement(Ve,{onClick:function(){o(""),e.handleDisconnect()},text:"back"}))));default:return null}}));function Qe(){var e=Object($.a)(["\n  margin-top: -8px;\n  flex-grow: 1;\n  display: flex;\n  flex-flow: row;\n  align-items: center;\n"]);return Qe=function(){return e},e}function Ze(){var e=Object($.a)(["\n  width: 0;\n  height: 0;\n"]);return Ze=function(){return e},e}function $e(){var e=Object($.a)(["var(--white)"]);return $e=function(){return e},e}function en(){var e=Object($.a)(["var(--aqua)"]);return en=function(){return e},e}function nn(){var e=Object($.a)(["\n      :after {\n        content: '';\n        width: 60%;\n        height: 50%;\n        background-color: ",";\n      }\n    "]);return nn=function(){return e},e}function tn(){var e=Object($.a)(["\n  width: calc(5vmin - 2px);\n  height: calc(5vmin - 2px);\n  min-width: 29px;\n  min-height: 29px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: var(--blue);\n\n  ","\n"]);return tn=function(){return e},e}function an(){var e=Object($.a)(["\n  margin-top: 8px;\n  display: grid;\n  grid-gap: 1px;\n  grid-template: repeat(7, auto) / repeat(8, auto);\n"]);return an=function(){return e},e}function rn(){var e=Object($.a)(["\n  padding: 16px 0 0;\n  height: 100%;\n  box-sizing: border-box;\n  display: flex;\n  flex-flow: column;\n  align-items: center;\n  justify-content: flex-start;\n  border: 3px double var(--white);\n\n  hr {\n    margin: 8px 0;\n    border: 0;\n    outline: 0;\n    width: 100%;\n    height: 1px;\n    background-color: var(--white);\n  }\n"]);return rn=function(){return e},e}function cn(){var e=Object($.a)(["\n  padding: 8px 4px;\n  margin: 8px 24px 24px 8px;\n  width: calc(50vmin - 36px);\n  height: calc(50vmin - 36px);\n  min-width: 276px;\n  min-height: 276px;\n  box-sizing: border-box;\n  position: relative;\n  background-color: var(--gray);\n  box-shadow: 16px 16px 0 var(--black);\n  color: var(--white);\n\n  :before {\n    content: '","';\n    padding: 0 8px;\n    position: absolute;\n    top: 2px;\n    left: 50%;\n    width: max-content;\n    height: 16px;\n    background-color: inherit;\n    color: inherit;\n    transform: translateX(-50%);\n    z-index: 1;\n  }\n"]);return cn=function(){return e},e}var on=ee.b.div(cn(),(function(e){return e.title_})),un=ee.b.div(rn()),ln=ee.b.div(an()),sn=ee.b.div(tn(),(function(e){return!e.isPlaced&&Object(ee.a)(nn(),e.isNext?Object(ee.a)(en()):Object(ee.a)($e()))})),dn=ee.b.div(Ze()),pn=ee.b.div(Qe()),fn=Object(l.b)((function(e){return{game:e.game,sea:e.sea}}),(function(e){return{ready:function(){return e({type:"READY"})},random:function(){return e({type:"RANDOM"})}}}))((function(e){var n=function(n){var t=n.type,a=n.ship,r=n.deck;return null!==e.sea.squadron[t][a][r]},t=function(t){var a=t.type,c=t.ship,o=t.deck;return r.a.createElement(sn,{isNext:e.sea.deckToPlace.type===a&&e.sea.deckToPlace.ship===c&&e.sea.deckToPlace.deck===o,isPlaced:n({type:a,ship:c,deck:o})})};return r.a.createElement(on,{title_:"place your ships"},r.a.createElement(un,null,"click on field to place",r.a.createElement("br",null),"or delete ship deck",r.a.createElement("hr",null),"ships left:",r.a.createElement(ln,null,Object(C.a)(Array(7)).reduce((function(n,a,c){return[].concat(Object(C.a)(n),c%2!==0?Object(C.a)(Object(C.a)(Array(8).keys()).map((function(e){return r.a.createElement(dn,{key:"".concat(e,"-").concat(c)})}))):Object(C.a)(e.sea.squadron[c/2].reduce((function(n,a,o){for(var i=o>0?e.sea.squadron[c/2][o-1].length*o+o:o,u=0;u<a.length;u++)n[u+i]=r.a.createElement(t,{key:"".concat(c/2,"-").concat(o,"-").concat(u),type:c/2,ship:e.sea.squadron[c/2].length-o-1,deck:a.length-u-1});return n}),Object(C.a)(Array(8)).map((function(e,n){return r.a.createElement(dn,{key:"".concat(n,"-").concat(c)})})))))}),[])),r.a.createElement("hr",null),r.a.createElement(pn,null,r.a.createElement(Ve,{text:"random",index:0,onClick:e.random,autoFocus:!0}),r.a.createElement(Ve,{text:"confirm",index:0,onClick:"confirm"===e.game.status&&e.ready}))))}));function hn(){var e=Object($.a)(["\n"]);return hn=function(){return e},e}function yn(){var e=Object($.a)(["\n  margin-top: 4em;\n  width: 100%;\n  line-height: 2.5em;\n  text-align: center;\n"]);return yn=function(){return e},e}function mn(){var e=Object($.a)(["\n  padding: 16px 0;\n  height: 100%;\n  box-sizing: border-box;\n  display: flex;\n  flex-flow: column;\n  align-items: center;\n  justify-content: space-between;\n  border: 3px double var(--black);\n"]);return mn=function(){return e},e}function bn(){var e=Object($.a)(["\n  padding: 8px 4px;\n  margin: -16px 0 0 -16px;\n  width: 270px;\n  height: 270px;\n  box-sizing: border-box;\n  position: relative;\n  background-color: var(--teal);\n  box-shadow: 16px 16px 0 var(--black);\n  color: var(--black);\n\n  :before {\n    content: '","';\n    padding: 0 8px;\n    position: absolute;\n    top: 2px;\n    left: 50%;\n    width: max-content;\n    height: 16px;\n    background-color: inherit;\n    color: inherit;\n    transform: translateX(-50%);\n    z-index: 1;\n  }\n"]);return bn=function(){return e},e}function vn(){var e=Object($.a)(["\n  margin: 8px;\n  width: calc(50vmin - 20px);\n  height: calc(50vmin - 20px);\n  min-width: 292px;\n  min-height: 292px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return vn=function(){return e},e}var gn=ee.b.div(vn()),En=ee.b.div(bn(),(function(e){return e.title_})),kn=ee.b.div(mn()),On=ee.b.div(yn()),xn=ee.b.div(hn()),jn=Object(l.b)((function(e){return{game:e.game}}),(function(e){return{repeat:function(){return e({type:"REPEAT"})},reset:function(){return e({type:"RESET"})}}}))((function(e){var n={victory:"you win!",defeat:"you loose!"};switch(e.game.status){case"defeat":case"victory":return e.game.isAllyWantRepeat?r.a.createElement(gn,null,r.a.createElement(En,{title_:n[e.game.status]},r.a.createElement(kn,null,r.a.createElement(On,null,"please wait for your opponent to answer")))):r.a.createElement(gn,null,r.a.createElement(En,{title_:n[e.game.status]},r.a.createElement(kn,null,r.a.createElement(On,null,!e.game.isAllyWantRepeat&&"play another round?",r.a.createElement("br",null),"pvp"===e.game.type&&e.game.isEnemyWantRepeat&&"your opponent insist"),r.a.createElement(xn,null,r.a.createElement(Ve,{text:"yes",index:0,onClick:e.repeat,autoFocus:!0}),r.a.createElement(Ve,{text:"no",index:0,onClick:e.reset})))));case"wait":return r.a.createElement(gn,null,r.a.createElement(En,{title_:"please wait"},r.a.createElement(kn,null,r.a.createElement(On,null,"your opponent",r.a.createElement("br",null),"placing their ships"))));default:return null}})),Sn=Object(l.b)((function(e){return{status:e.game.status}}))((function(e){switch(e.status){case"choose":case"connect":return r.a.createElement(Ke,null);case"place":case"confirm":return r.a.createElement(je,null,r.a.createElement(ke,null),r.a.createElement(fn,null));case"victory":case"wait":return r.a.createElement(je,null,r.a.createElement(ke,null),r.a.createElement(jn,null));case"play":return r.a.createElement(je,null,r.a.createElement(ke,null),r.a.createElement(Oe,null));case"defeat":return r.a.createElement(je,null,r.a.createElement(jn,null),r.a.createElement(Oe,null));default:return null}})),wn=Object(l.b)((function(e){return{game:e.game,peer:e.peer,sea:e.sea}}),(function(e){return{changeStatus:function(n){return e({type:"CHANGE_STATUS",payload:n})},selectType:function(n){return e({type:"SELECT_TYPE",payload:n})},setInterface:function(n){return e({type:"SET_INTERFACE",payload:n})},setMove:function(n){return e({type:"SET_MOVE",payload:n})},post:function(n){return e({type:"RECEIVE",payload:n})},clearMessage:function(){return e({type:"CLEAR_MESSAGE"})},send:function(n){return e({type:"SEND",payload:n})},connect:function(){return e({type:"SET_IS_CONNECTED"})},newRound:function(){return e({type:"NEW_ROUND"})},random:function(){return e({type:"RANDOM"})},repeat:function(){return e({type:"REPEAT"})},ready:function(){return e({type:"READY"})},reset:function(){return e({type:"RESET"})}}}))((function(e){var n=function(n){var t=n.key.toLowerCase();switch(e.game.status){case"choose":"p"===t&&e.selectType(!0),"c"===t&&e.selectType(!1);break;case"place":"r"===t&&e.random();break;case"confirm":"r"===t&&e.random(),"c"===t&&e.ready();break;case"defeat":case"victory":"y"===t&&e.repeat(),"n"===t&&e.reset()}};return Object(a.useEffect)((function(){switch(document.removeEventListener("keypress",n),e.game.status){case"choose":document.addEventListener("keypress",n);break;case"connect":e.peer.isConnected&&(e.setMove(e.peer.isClient),e.changeStatus("place"));break;case"place":"comp"===e.game.type&&null===e.peer.interface&&e.setInterface(new Z({connect:e.connect,post:e.post})),0===e.sea.shipsToPlace&&e.changeStatus("confirm"),document.addEventListener("keypress",n);break;case"confirm":if(0!==e.sea.shipsToPlace){e.changeStatus("place");break}if(e.game.isAllyReady){e.changeStatus(e.game.isEnemyReady?"play":"wait");break}document.addEventListener("keypress",n);break;case"wait":e.game.isEnemyReady&&e.changeStatus("play");break;case"play":break;case"defeat":case"victory":if(e.game.isAllyWantRepeat){e.game.isEnemyWantRepeat&&e.newRound();break}document.addEventListener("keypress",n)}return e.peer.message?(e.peer.interface.send(e.peer.message),e.clearMessage()):e.sea.feedback&&e.send(e.sea.feedback),function(){return document.removeEventListener("keypress",n)}}),[e]),r.a.createElement(Sn,null)}));o.a.render(r.a.createElement(l.a,{store:K},r.a.createElement(i.a,null,r.a.createElement(u.a,{path:"/",component:wn}))),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.6e5295c5.chunk.js.map